@page "/login"

<PageTitle>Connexion - Cameras Monitor</PageTitle>

<MudContainer MaxWidth="MaxWidth.Small" Class="py-8">
    <MudStack Spacing="4" AlignItems="AlignItems.Center">

        @* Header *@
        <MudStack AlignItems="AlignItems.Center" Spacing="1">
            <MudStack Row AlignItems="AlignItems.Center" Spacing="2">
                <MudAvatar Color="Color.Primary" Variant="Variant.Filled" Size="Size.Large" Class="gradient-primary">
                    <MudIcon Icon="@Icons.Material.Filled.Home" />
                </MudAvatar>
                <MudText Typo="Typo.h5" Class="fw-bold">The house of tonito !</MudText>
            </MudStack>
            <MudText Typo="Typo.subtitle1" Color="Color.Secondary">Connexion requise</MudText>
        </MudStack>

        @* Card principale *@
        <MudPaper Class="pa-6 glass-card" Elevation="0" Style="width: 100%; max-width: 400px;">
            <MudStack Spacing="4">
                <MudStack AlignItems="AlignItems.Center" Spacing="1">
                    <MudText Typo="Typo.h5" Class="gradient-text">Authentification</MudText>
                    <MudText Typo="Typo.body2" Color="Color.Secondary" Align="Align.Center">
                        Veuillez entrer vos identifiants pour acceder aux cameras.
                    </MudText>
                </MudStack>

                @if (_showError)
                {
                    <MudAlert Severity="Severity.Error" Variant="Variant.Filled" Dense="true">
                        Identifiants incorrects. Veuillez reessayer.
                    </MudAlert>
                }

                <form method="post" action="/api/login">
                    <MudStack Spacing="3">
                        <MudTextField T="string"
                                      Label="Nom d'utilisateur"
                                      name="username"
                                      Required="true"
                                      RequiredError="Nom d'utilisateur requis"
                                      Variant="Variant.Outlined"
                                      autocomplete="username"
                                      Adornment="Adornment.Start"
                                      AdornmentIcon="@Icons.Material.Filled.Person" />

                        <MudTextField T="string"
                                      Label="Mot de passe"
                                      name="password"
                                      InputType="InputType.Password"
                                      Required="true"
                                      RequiredError="Mot de passe requis"
                                      Variant="Variant.Outlined"
                                      autocomplete="current-password"
                                      Adornment="Adornment.Start"
                                      AdornmentIcon="@Icons.Material.Filled.Lock" />

                        <MudButton ButtonType="ButtonType.Submit"
                                   Variant="Variant.Filled"
                                   Color="Color.Primary"
                                   Size="Size.Large"
                                   FullWidth="true"
                                   Class="gradient-button mt-2"
                                   StartIcon="@Icons.Material.Filled.Login">
                            Se connecter
                        </MudButton>
                    </MudStack>
                </form>
            </MudStack>
        </MudPaper>

        @* Footer *@
        <MudText Typo="Typo.caption" Color="Color.Secondary" Class="mt-4">
            Â© Tonito
        </MudText>
    </MudStack>
</MudContainer>

@code {
    private bool _showError;

    [SupplyParameterFromQuery(Name = "error")]
    public string? Error { get; set; }

    protected override void OnInitialized()
    {
        _showError = Error == "1";
    }
}
